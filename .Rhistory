blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
library(tidyverse)
# install.packages("scales")
# install.packages("lmtest")
library(scales)
x_mu <- .01
x_sig <- .1
y_mu <- .03
y_sig <- .2
rho <-  0.72
howfar <- 60
#set.seed(59)
set.seed(158)
returns <- tibble(index = 1:howfar)
returns$x1 <- rnorm(howfar)
returns$y1 <- rnorm(howfar)
returns1 <- returns %>% mutate(
y2 = rho*x1 + sqrt(1 - rho^2)*y1,
r_x = x_mu + x1 * x_sig,
r_y = y_mu + y2 * y_sig
)
x_sd <- sd(returns1$r_x)
y_sd <- sd(returns1$r_y)
rho_xy <- cor(returns1$r_x, returns1$r_y)
beta_xy <- rho_xy * y_sd / x_sd
x_mu_act <- mean(returns1$r_x)
y_mu_act <- mean(returns1$r_y)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Excess returns of benchmark") +
ylab("Excess returns of portfolio") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1))
returns1_model1 <- lm(r_y ~ r_x, data = returns1)
summary(returns1_model1)
hold <- mean(returns1$r_x)
mean(returns1$r_y)
new.df <- data.frame(r_x = c(0, .01, hold, 0.02, 0.05, 0.1))
predict(returns1_model1, new.df)
(cor(returns1$r_x, returns1$r_y)*sd(returns1$r_y))/sd(returns1$r_x)
plot (returns1_model1)
# bptest(returns1_model1)
library(lmtest)
library(ggthemes)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Excess returns of benchmark") +
ylab("Excess returns of portfolio") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_tufte()
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Excess returns of benchmark") +
ylab("Excess returns of portfolio") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_gdocs()
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Excess returns of benchmark") +
ylab("Excess returns of portfolio") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_few()
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Excess returns of benchmark") +
ylab("Excess returns of portfolio") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_calc()
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Excess returns of benchmark") +
ylab("Excess returns of portfolio") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_few()
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_few()
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_few()
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_linedraw()
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light()
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14)
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14)
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14)
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14)
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(t = 20)),
axis.text.y = element_text(size = 14)
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 20)),
axis.text.y = element_text(size = 14)
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14)
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(r = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen") +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linetype = "dashed") +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linetype = "dashed", width = 3) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linetype = "dashed", width = 6) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linetype = "dashed", linewidth = 6) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linetype = "dashed", size = 6) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linetype = "dashed", size = 2) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linetype = "longdash", size = 2) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkblue", linetype = "longdash", size = 2) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkblue", linetype = "longdash", size = 1) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkblue", linetype = "longdash", size = 1.5) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "green", linetype = "longdash", size = 1.5) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "bluish green", linetype = "longdash", size = 1.5) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "bluish Green", linetype = "longdash", size = 1.5) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "forestgreen", linetype = "longdash", size = 1.5) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
(cor(returns1$r_x, returns1$r_y)*sd(returns1$r_y))/sd(returns1$r_x)
blogdown:::serve_site()
blogdown:::serve_site()
df_fit <- lm(Inflation_Rate ~ Unemployment, data = df2)
startdate <- "1980-01-01"
enddate <- "2020-01-01"
# Phillips x = unemployment
unrate <- get_fred_series("UNRATE", "Unemployment", observation_start = startdate, observation_end = enddate)
df_fit <- lm(Inflation_Rate ~ Unemployment, data = df2)
blogdown:::new_post_addin()
blogdown:::serve_site()
