geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14)
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14)
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14)
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(t = 20)),
axis.text.y = element_text(size = 14)
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 20)),
axis.text.y = element_text(size = 14)
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14)
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(r = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Here is a scatterplolt") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen") +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linetype = "dashed") +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linetype = "dashed", width = 3) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linetype = "dashed", width = 6) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linetype = "dashed", linewidth = 6) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linetype = "dashed", size = 6) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linetype = "dashed", size = 2) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkgreen", linetype = "longdash", size = 2) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkblue", linetype = "longdash", size = 2) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkblue", linetype = "longdash", size = 1) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "darkblue", linetype = "longdash", size = 1.5) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "green", linetype = "longdash", size = 1.5) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "bluish green", linetype = "longdash", size = 1.5) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "bluish Green", linetype = "longdash", size = 1.5) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "forestgreen", linetype = "longdash", size = 1.5) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
(cor(returns1$r_x, returns1$r_y)*sd(returns1$r_y))/sd(returns1$r_x)
blogdown:::serve_site()
blogdown:::serve_site()
df_fit <- lm(Inflation_Rate ~ Unemployment, data = df2)
startdate <- "1980-01-01"
enddate <- "2020-01-01"
# Phillips x = unemployment
unrate <- get_fred_series("UNRATE", "Unemployment", observation_start = startdate, observation_end = enddate)
df_fit <- lm(Inflation_Rate ~ Unemployment, data = df2)
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "forestgreen", linetype = "longdash", size = 1.5) +
ggtitle("Investment fund versus benchmark: Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
plot.title = element_text(size = 16),
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
blogdown:::serve_site()
blogdown:::serve_site()
library(tidyverse)
library(scales)
library(ggthemes)
# library(lmtest)
x_mu <- .01; x_sig <- .1
y_mu <- .03; y_sig <- .2
rho <-  0.72
months <- 60
#set.seed(59)
set.seed(158)
# 60  rows of random standard normals
returns <- tibble(index = 1:months)
returns$x1 <- rnorm(months)
returns$y1 <- rnorm(months)
# make y2 correlated with y1; adjust location/scale
returns1 <- returns %>% mutate(
y2 = rho*x1 + sqrt(1 - rho^2)*y1,
r_x = x_mu + x1 * x_sig,
r_y = y_mu + y2 * y_sig
)
x_sd <- sd(returns1$r_x)
y_sd <- sd(returns1$r_y)
rho_xy <- cor(returns1$r_x, returns1$r_y)
beta_yx <- rho_xy * y_sd / x_sd
x_mu_act <- mean(returns1$r_x)
y_mu_act <- mean(returns1$r_y)
sprintf("sample rho is %.4f. The standard deviation of Portfolio returns is ", rho_xy)
paste("Portfolio standard deviation is", percent(y_sd, accuracy = .01))
paste("Benchmark standard deviation is", percent(x_sd, accuracy = .01))
paste("Portfolio average excess return is", percent(y_mu_act, accuracy = .01))
paste("Benchmark average excess return is", percent(x_mu_act, accuracy = .01))
sprintf("Beta(P,B) is %.3f", beta_yx)
returns1_lm <- lm(r_y ~ r_x, data = returns1)
summary(returns1_lm)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "forestgreen", linetype = "longdash", size = 1.5) +
ggtitle("Investment fund versus benchmark") +
ggsubtitle("Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
# plot.title = element_text(size = 16),
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
?ATOP
?atop
library(tidyverse)
library(scales)
library(ggthemes)
# library(lmtest)
x_mu <- .01; x_sig <- .1
y_mu <- .03; y_sig <- .2
rho <-  0.72
months <- 60
#set.seed(59)
set.seed(158)
# 60  rows of random standard normals
returns <- tibble(index = 1:months)
returns$x1 <- rnorm(months)
returns$y1 <- rnorm(months)
# make y2 correlated with y1; adjust location/scale
returns1 <- returns %>% mutate(
y2 = rho*x1 + sqrt(1 - rho^2)*y1,
r_x = x_mu + x1 * x_sig,
r_y = y_mu + y2 * y_sig
)
x_sd <- sd(returns1$r_x)
y_sd <- sd(returns1$r_y)
rho_xy <- cor(returns1$r_x, returns1$r_y)
beta_yx <- rho_xy * y_sd / x_sd
x_mu_act <- mean(returns1$r_x)
y_mu_act <- mean(returns1$r_y)
sprintf("sample rho is %.4f. The standard deviation of Portfolio returns is ", rho_xy)
paste("Portfolio standard deviation is", percent(y_sd, accuracy = .01))
paste("Benchmark standard deviation is", percent(x_sd, accuracy = .01))
paste("Portfolio average excess return is", percent(y_mu_act, accuracy = .01))
paste("Benchmark average excess return is", percent(x_mu_act, accuracy = .01))
sprintf("Beta(P,B) is %.3f", beta_yx)
returns1_lm <- lm(r_y ~ r_x, data = returns1)
summary(returns1_lm)
returns1 %>% ggplot(aes(x = r_x, y = r_y)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "forestgreen", linetype = "longdash", size = 1.5) +
labs(title = "Investment fund versus benchmark",
subtitle = "Excess returns, n = 60 months") +
xlab("Benchmark's excess returns") +
ylab("Portfolio's excess returns") +
scale_x_continuous(labels = percent_format(accuracy = 1)) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_light() +
theme(
plot.title = element_text(size = 16),
plot.subtitle = element_text(size = 16),
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14, margin = margin(b = 10)),
axis.text.y = element_text(size = 14, margin = margin(l = 10))
)
plot(returns1_lm)
new.df <- data.frame(r_x = c(x_mu_act, 0, seq(from = 0.01, to = 0.1, by = .01)))
new.df$predicted_y <- predict(returns1_lm, new.df)
new.df
intercept_predict <- (0 - x_mu_act)*beta_yx + y_mu_act
intercept_predict_round <- (0 - round(x_mu_act,4))*beta_yx + round(y_mu_act,4)
intercept_predict
intercept_predict_round
# install.packages("gt")
# library(broom)
rentals_raw <- read.csv("housing.csv")
# rentals_sort <- rentals %>% arrange(price)
rentals_df1 <- rentals_raw %>% filter(price > 500, price < 10000,
sqfeet> 500, sqfeet < 10000)
setwd("D:/etc/frm")
# install.packages("gt")
# library(broom)
rentals_raw <- read.csv("housing.csv")
# rentals_sort <- rentals %>% arrange(price)
rentals_df1 <- rentals_raw %>% filter(price > 500, price < 10000,
sqfeet> 500, sqfeet < 10000)
